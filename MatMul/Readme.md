# MatMul
*Данная лабораторная работа заключается в реализации перемножения двух матриц используя программно-аппаратную архитектуру CUDA*
* Лабораторная представлена 3 файлами: .h .cu и make
* В файле .cu содержится функция ядра
* В файле .h содержится код хоста и функция для последовательного умножения 2х матриц
* make файл используется для компоновки и представляетс собой файл с флагами
* После компоновки, используя команду *make* код запускается с помощью команды *./MatMul 1й_арг 2й_арг 3й_арг 4й_арг*
* 1й_арг, 2й_арг и 3й_арг это размерности входных матриц, а 4й_арг флаг автозаполнения матриц

##### .h устроен так: 
1. После инициализации размерностей определяется количество блоков в гриде (блоки всегда имеют размер (32,32))
2. Выделяется память под 4 массива: A, B, CGPU, CCPU
3. Происходит инициализация массивов (либо автоматически, либо ввод с консоли), если все размерности меньше 10, то их выведет в консоль
4. Выделяется память на GPU, создаются ивенты для дальнейшего замера времени
5. Копируются массивы с хоста на девайс в их аналоги
6. Засекается время старта, вызывается функция ядра, синхронизируются CPU и GPU, засекается время конца
7. Массив С копируется с GPU на CPU
8. Производится замер времени, вызов функции для последовательного умножения, замер времени
9. Выводятся время работы каждой функции, а также максимум модуля разности между CGPU и CCPU
10. Очищается память  
##### .cu устроен так: 
1. Используется виртуальная архитектура CUDA для вычисления 1го и 2го индекса каждой нити 
2. Все матрицы объявляются и заполняются как одномерные вектора. 
2. Так как данные матрицы хранятся линейно, то чтобы не записывались "неправильные" данные ограничиваются индексы у нитей, которые могут вычислять c[i,j]
3. Нити, которая вычисляут  c[i,j], последовательно проходит по строке матрицы A и стоблцу матрицы B, прибавляя на каждом этапе их произведение ( C - изначельно инициализирована как нулевая матрица)
##### В excele находятся данные измерений
* по графику видно, что ускорение увеличивается с возрастанием размерностей матриц <br>
Также представлены несколько примеров запуска кода
* Для матриц проведена проверка работы функций (2 примера) 

* Чтобы вводить самому, нужно 4 входной агрумент == 0 и если m,n или k > 9, то не будет вывода матриц в консоль
